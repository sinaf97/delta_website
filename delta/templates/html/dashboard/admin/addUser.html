{% include "html/dashboard/admin/layout.html" %}

{% block main %}

        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
         <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
           <h3 class="h3 font-weight-bold">{{user.first_name}} {{user.last_name}}<br/><span class="h5">{{user.role}}</span></h3>
           <div class="mb-2 mb-md-0">
               <img src="../static/pic/head.png" style="width:10%;float:right">
           </div>
         </div>
         <form id="add-user-form" action="{%url 'add_user_submit'%}" class="form" method="post" style="border:1px solid grey;border-radius:5px;margin-bottom:10%">
           {%csrf_token%}
           <div style="margin:10px">
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="firstName">First name</label>
                <input type="text" class="form-control" id="firstName" placeholder="Sina" name="firstName" required>
              </div>
              <div class="form-group col-md-6">
                <label for="lastName">Last name</label>
                <input type="text" class="form-control" id="lastName" placeholder="Farahani" name="lastName" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="username">Username</label>
                <input type="text" class="form-control" id="username" placeholder="sina86" name="username" required>
                <p id="check_username"></p>
              </div>
              <div class="form-group col-md-6">
                <label for="idNumber">ID Number</label>
                <input type="text" class="form-control" id="idNumber" placeholder="123456789" name="idNumber" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="phone">Phone</label>
                <input type="tel" class="form-control" id="phone" placeholder="07154123456" name="phone" required>
              </div>
              <div class="form-group col-md-6">
                <label for="mobile">Mobile</label>
                <input type="tel" class="form-control" id="mobile" placeholder="09123456789" name="mobile" required>
              </div>
            </div>
            <div class="form-group">
              <label for="inputAddress">Address</label>
              <input type="text" class="form-control" id="inputAddress" placeholder="1234 Main St" name="address">
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="email">Email</label>
                <input type="email" class="form-control" id="email" placeholder="someone@example.com" name="email">
              </div>
              <div class="form-group col-md-4">
                <label for="role">Role</label>
                <select id="role" class="form-control" name="role">
                  <option selected>Choose...</option>
                  <option>Teacher</option>
                  <option>Student</option>
                  <option>Staff</option>
                </select>
              </div>
              <button type="submit" class="btn btn-primary btn-block" style="margin:5% 0" id="submit">Submit</button>
            </div>
            <div>
          </form>
       </main>
        </div>
      </div>


          <!-- Central Modal Medium Success -->
            <div class="modal fade" id="centralModalSuccess" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
              aria-hidden="true">
              <div class="modal-dialog modal-notify modal-success" role="document">
                <!--Content-->
                <div class="modal-content">
                  <!--Header-->
                  <div class="modal-header">
                    <p class="heading lead">Status</p>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true" class="white-text">&times;</span>
                    </button>
                  </div>

                  <!--Body-->
                  <div class="modal-body">
                    <div class="text-center">
                      <p id="status"></p>
                    </div>
                  </div>

                  <!--Footer-->
                  <div class="modal-footer justify-content-center">
                    <a type="button" class="btn btn-outline-primary waves-effect" data-dismiss="modal">Close</a>
                  </div>
                </div>
                <!--/.Content-->
              </div>
            </div>
            <!-- Central Modal Medium Success-->
{% endblock %}



<script type="text/javascript">

    $('#add').addClass("active")
    $('#add-user').addClass("active")
    $('#collapseAdd').addClass("show")
    $('#add').attr("aria-expanded","true")


    $("#username").blur(validate_username)
    $('#submit').click(submit_form)

    function validate_username(){
      var username = $(this).val();
      if(username == "")
        $('#check_username').html("");
      else{
      $.ajax({
        url: "{%url 'validate_username'%}",
        data: {
          'username': username
        },
        method:'GET',
        dataType: 'json',
        success: function (data) {
          $('#check_username').html(data.msg);
          if(data.status)
             $('#check_username').css("color","green");
           else
             $('#check_username').css("color","red");
        }
      });

    }}

    function submit_form(){
      $('#add-user-form').ajaxForm({
      success: function (data) {
        $('#status').html(data.status)
       $('#centralModalSuccess').modal()
       if(data.ok)
          document.getElementById('add-user-form').reset();
        $('#check_username').html("");
      },
        dataType:'json',
    })

  }




</script>
